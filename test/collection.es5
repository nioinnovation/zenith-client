'use strict';

var collectionSuite = function collectionSuite(getHorizon, getData, getTestData) {
  return function () {
    var horizon = undefined,
        data = undefined,
        testData = undefined,
        empty_collection = undefined;

    before(function () {
      horizon = getHorizon();
      data = getData();
      testData = getTestData();
    });

    // We'll need a separate empty collection
    before(function (done) {
      empty_collection = horizon('empty_test_collection');
      removeAllData(empty_collection, done);
    });

    // Grab everything from the collection.
    it('allows getting all values from the collection', assertCompletes(function () {
      return data.fetch({ asCursor: false }).do(function (res) {
        return assert.sameDeepMembers(testData, res);
      });
    }));

    // Reading from an empty collection should result in an empty array
    it('returns an empty array from an empty collection', assertCompletes(function () {
      return empty_collection.fetch({ asCursor: false }).do(function (res) {
        return assert.sameDeepMembers(res, []);
      });
    }));
  };
}; // Testing full collection reads